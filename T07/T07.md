### Tạo S3 (Simple Storage Service)

Tạo file main.tf
```
resource "aws_s3_bucket" "web_static" {
  bucket = "test-name-s3"
  acl = "public-read"
  policy = {
    "Version": "2012-10-17",
    "Statement": [
      {
        "Sid": "PublicReadGetObject",
        "Effect": "Allow",
        "Principal": "*",
        "Action": [
          "s3:GetObject"
        ],
        "Resource": [
          "arn:aws:s3:::terraform-series-bai3/*"
        ]
      }
    ]
  }
  website {
    index_document = "index.html"
    error_document = "error.html"
  }
}
```
Đoạn cấu hình policy hơi dài và có dạng json. Ta cho thành ra 1 file riêng `s3_static_policy.json`
```
{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Sid": "PublicReadGetObject",
      "Effect": "Allow",
      "Principal": "*",
      "Action": [
        "s3:GetObject"
      ],
      "Resource": [
        "arn:aws:s3:::terraform-series-bai3/*"
      ]
    }
  ]
}
```
Sau đó, import đoạn cấu hình vào `main.tf` bằng function `file()`
```
resource "aws_s3_bucket" "web_static" {
  bucket = "test-name-s3"
  acl = "public-read"
  policy = file("s3_web_static_policy")
  website {
    index_document = "index.html"
    error_document = "error.html"
  }
}
```
---
***UPDATE***

Argument `acl` và `policy` `website` trong `aws_s3_bucket` không được sử dụng trong version mới. Thay thế đó là block resource `aws_s3_bucket_acl` và `aws_s3_bucket_policy`, `aws_s3_bucket_website_configuration`
```
resource "aws_s3_bucket_acl" "web_static_acl" {
  bucket = aws_s3_bucket.web_static.id
  acl = "public-read"
}
```
```
resource "aws_s3_bucket_policy" "web_static_policy" {
  bucket = aws_s3_bucket.web_static.id
  policy = data.aws_iam_policy_document.allow_acces_web_static.json
}
```
```
resource "aws_s3_bucket_website_configuration" "web_static_web" {
  bucket = aws_s3_bucket.web_static.bucket
  index_document {
    suffix = "index.html"
  }
  error_document {
    key = "error.html"
  }
}
```
File `s3_web_static_policy.json` viết thành block data `aws_iam_policy_document`
```
data "aws_iam_policy_document" "allow_acces_web_static" {
  statement {
    sid = "PublicReadGetObject"
    effect = "Allow"
    principals {
      type = "*"
      identifiers = ["*"]
    }
    actions = ["s3:GetObject"]
    resources = ["arn:aws:s3:::terraform-series-bai3/*"]
  }
}
```
